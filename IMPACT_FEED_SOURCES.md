# Impact Feed - What Populates It

## Overview
The Impact Feed is populated from multiple sources, prioritized to show the most relevant and up-to-date content. Here's everything that can appear in your feed:

---

## 1. **Backend API Feed Items** (Primary Source - Highest Priority)

### Source: `/api/feed` endpoint
These are feed items **stored in the database** and created by the backend.

### When They're Created:

#### A. **When a Project is Created** (`POST /api/projects`)
- **Trigger**: User creates a new project
- **Condition**: Only if `isPublic: true`
- **Feed Item Type**: `'project'`
- **Title Format**: `"New Project: {projectTitle}"`
- **What Gets Included**:
  - Project description
  - Author information (name, avatar, ID)
  - Location, category, tags
  - University, team members
  - Deadline (if urgent, shows urgent badge)
  - Status (active = high significance, others = medium)
- **Real-time**: Emits `feed_item_added` via WebSocket for instant updates

**Example**:
```typescript
{
  id: "feed_project_7f338504-89de-4652-9834-5df3b31dbe60",
  type: "project",
  title: "New Project: AI Ethics Research",
  description: "Research project on AI ethics...",
  timestamp: "2024-01-15T10:30:00.000Z",
  authorId: "user-123",
  authorName: "Dr. Sarah Chen",
  projectId: "7f338504-89de-4652-9834-5df3b31dbe60",
  visibility: "public",
  significance: "high", // or "medium" if not active
  isAutoGenerated: true
}
```

#### B. **Admin Highlights** (`POST /api/feed/admin/highlights`)
- **Trigger**: Admin creates a highlight
- **Feed Item Type**: `'admin_highlight'`
- **Features**:
  - Can be pinned (`isPinned: true`)
  - Can have expiration date
  - Shows "FEATURED" badge
  - Can link to projects or opportunities

#### C. **User Actions** (`POST /api/feed/actions`)
- **Trigger**: User performs significant actions
- **Feed Item Types**: `'milestone'`, `'achievement'`, `'certification'`, etc.
- **Examples**:
  - Milestone achieved
  - Project completed
  - Certification earned

---

## 2. **Generated Feed Items from Projects** (Secondary Source)

### Source: Frontend `FeedService.generateProjectFeedItems()`
These are **generated on-the-fly** from projects fetched from `/api/projects`.

### When They're Created:
- **Trigger**: Feed loads and fetches projects from API
- **Purpose**: Ensures projects show in feed even if backend didn't create feed items
- **Condition**: Only for projects that don't already have feed items in the database

### What Gets Generated:

#### A. **Project Creation Feed Items**
- **Type**: `'project'`
- **Title**: `"New Project: {projectTitle}"`
- **For**: All projects from API (no date filter - these are real projects)

#### B. **Success Story Feed Items** (for closed projects)
- **Type**: `'success_story'`
- **Title**: `"Project Completed: {projectTitle}"`
- **Condition**: Only if project status is `'closed'` and closed within last 7 days
- **Description**: `"Successfully completed {aspiraCategory} project in {category}"`

**Example**:
```typescript
{
  id: "feed_project_closed_abc123",
  type: "success_story",
  title: "Project Completed: Healthcare Mentorship",
  description: "Successfully completed mentorships project in Healthcare",
  timestamp: "2024-01-10T10:00:00.000Z",
  // ... other fields
}
```

---

## 3. **Generated Feed Items from Opportunities** (Currently Disabled)

### Source: Frontend `FeedService.generateOpportunityFeedItems()`
- **Status**: Currently returns empty array (no demo data)
- **Future**: Will generate from `/api/opportunities` when implemented
- **Type**: `'opportunity'`

---

## Feed Item Priority & Combination Logic

The feed combines items in this order (highest to lowest priority):

1. **API Feed Items** (from `/api/feed`)
   - Stored in database
   - Most accurate and up-to-date
   - Created by backend when projects/opportunities are created

2. **Generated Project Feed Items** (from `/api/projects`)
   - Generated on-the-fly
   - Only if they don't already exist in API feed items
   - Ensures all projects appear in feed

3. **Generated Opportunity Feed Items** (from `/api/opportunities`)
   - Currently disabled (returns empty array)

### Deduplication:
- Items are deduplicated by `id`
- If an item exists in both API feed items and generated items, the API version takes precedence
- Format: `feed_project_{projectId}` or `feed_project_closed_{projectId}`

---

## Feed Item Types

The feed can display these types of items:

1. **`'project'`** - New projects created by users
2. **`'campaign'`** - Campaigns (university campaigns, fundraising, etc.)
3. **`'opportunity'`** - Opportunities (scholarships, jobs, internships, etc.)
4. **`'milestone'`** - Project milestones achieved
5. **`'success_story'`** - Completed projects (success stories)
6. **`'funding_success'`** - Successful funding campaigns
7. **`'live_event'`** - Live events happening now
8. **`'workroom_live'`** - Active workrooms
9. **`'project_closing'`** - Projects closing soon
10. **`'admin_highlight'`** - Admin-curated featured content
11. **`'achievement'`** - User achievements
12. **`'certification'`** - Certifications earned
13. **`'collaboration'`** - Collaboration events

---

## Real-Time Updates

### WebSocket Events:
- **`feed_item_added`**: When a new feed item is created
- **`feed_item_updated`**: When an existing feed item is updated

### Polling Fallback:
- If WebSocket fails, feed polls every 30 seconds for updates

---

## What Does NOT Populate the Feed (Removed)

❌ **Demo/Mock Data**:
- `realProjects` array (not used)
- `realOpportunities` array (not used)
- `initializeMockData()` (disabled)
- Local `this.feedItems` array (removed from combination)

❌ **Private Projects**:
- Projects with `isPublic: false` do not create feed items

---

## Current Feed Flow

```
1. User creates project (POST /api/projects)
   ↓
2. Backend checks if isPublic === true
   ↓
3. Backend creates FeedItem in database
   ↓
4. Backend emits 'feed_item_added' via WebSocket
   ↓
5. Frontend receives WebSocket event
   ↓
6. Frontend fetches updated feed from /api/feed
   ↓
7. Feed displays new project immediately
```

**Fallback Flow** (if WebSocket fails):
```
1. Frontend polls /api/feed every 30 seconds
2. Frontend also generates feed items from /api/projects
3. Combines both sources, removes duplicates
4. Displays in feed
```

---

## Summary

**What Populates the Feed:**
✅ Feed items from backend database (`/api/feed`)
✅ Generated items from real projects (`/api/projects`)
✅ Admin highlights (created by admins)
✅ User actions (milestones, achievements, etc.)

**What Does NOT Populate:**
❌ Demo/mock data
❌ Private projects (`isPublic: false`)
❌ Local frontend-only data

**Priority:**
1. Backend API feed items (database)
2. Generated items from real projects
3. Real-time updates via WebSocket
4. Polling fallback every 30 seconds

The feed is **100% backend-driven** with no demo data!

